/**
Date: 2017-5-25
Author: CC

example:
    $('.ccSlider').ccSlider();

    <div class="ccSlider">
        <div class="ccSlider-item"></div>
        <div class="ccSlider-item"></div>
        <div class="ccSlider-item"></div>
        <div class="ccSlider-item"></div>
    </div>
*/

!function(a){function b(b,c){this.$container=b,this.options=a.extend({startSlide:0,item:".ccSlider-item",isFullScreen:!1,isFlexible:!1,isSupportTouch:"__proto__"in{},isHover:!0,isShowPage:!0,isShowTitle:!1,titleAttr:"data-title",isShowControls:!0,isAuto:!0,intervalTime:5e3,affectTime:300,mode:"move",direction:"left",onSwipeStart:a.noop,onSwipeMove:a.noop,minSwipeLength:30,onSwipeCancel:a.noop,onSwipeEnd:a.noop,onSwipeLeft:a.noop,onSwipeRight:a.noop,onSwipeTop:a.noop,onSwipeBottom:a.noop,onInited:a.noop,onMoveBefore:a.noop,onMoveAfter:a.noop,onSelected:a.noop},c),this.init()}b.prototype={init:function(){this.$item=this.$container.find(this.options.item),this.size=this.$item.size(),this.curIndex=this.options.startSlide,this.setLayout(),this.playTimer=null,this.options.isAuto&&this.autoPlay(),this.options.isFlexible&&a(window).on("resize.ccSlider",a.proxy(this,"resize")),this.options.isSupportTouch&&this.touch(),this.onHover()},touch:function(){var a=this,b={},c=this.options,d=c.minSwipeLength;this.$container.on("touchstart",function(a){var d=a.originalEvent.touches[0];b.x1=d.pageX,b.y1=d.pageY,c.onSwipeStart.call(this,b)}).on("touchmove",function(a){var d=a.originalEvent.touches[0];b.x2=d.pageX,b.y2=d.pageY,c.onSwipeMove.call(this,b)}).on("touchend",function(){if(b.x2&&Math.abs(b.x1-b.x2)>d||b.y2&&Math.abs(b.y1-b.y2)>d){var f=a.swipeDirection(b.x1,b.x2,b.y1,b.y2);c["onSwipe"+f].call(this,b),a.moveTo(f),c.onSwipeEnd.call(this,b)}else c.onSwipeCancel.call(this,b);b={}})},moveTo:function(a){var b=this,c=b.options.direction;"top"==c?"Bottom"==a?b[b.options.mode+"Prev"]():"Top"==a&&b[b.options.mode]():"left"==c&&("Right"==a?b[b.options.mode+"Prev"]():"Left"==a&&b[b.options.mode]())},swipeDirection:function(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Top":"Bottom"},move:function(){var b,a=this;a.options.isAuto&&a.autoPlay(),++a.curIndex==a.size&&(a.curIndex=0,a.$container.css(a.getMove()),a.curIndex++),a.setTitle(),a.setPages(),b=a.curIndex==a.size-1?0:a.curIndex,a.options.onMoveBefore.call(a.$container,a.$item,b),a.$container.stop(!1,!0).animate(a.getMove(),a.options.affectTime,function(){a.options.onMoveAfter.call(this,a.$item,b)})},movePrev:function(a){var b=this;1!=a&&("move"==b.options.mode?0==b.curIndex&&(b.curIndex=b.size-1,b.$container.css(b.getMove())):0==b.curIndex&&(b.curIndex=b.size),b.curIndex--),b.options.isAuto&&b.autoPlay(),b.setTitle(),b.setPages(),b.options.onMoveBefore.call(b.$container,b.$item,b.curIndex),b.$container.stop(!1,!0).animate(b.getMove(),b.options.affectTime,function(){b.options.onMoveAfter.call(this,b.$item,b.curIndex)})},getMove:function(a){var b={},c=this.getSize(),d=this.options.direction;return"top"==d?(b.top=-this.curIndex*c.height,a&&(b.width=c.width)):(b.left=-this.curIndex*c.width,a&&(b.height=c.height)),b},fade:function(){var a=this;a.options.isAuto&&a.autoPlay(),a.curIndex++,a.curIndex>a.size-1&&(a.curIndex=0),a.setTitle(),a.setPages(),a.options.onMoveBefore.call(a.$container,a.$item,a.curIndex),a.$item.fadeOut(a.options.affectTime).eq(a.curIndex).fadeIn(a.options.affectTime,function(){a.options.onMoveAfter.call(this,a.$item,a.curIndex)})},fadePrev:function(a){var b=this;1!=a&&("move"==b.options.mode?0==b.curIndex&&(b.curIndex=b.size-1,b.$container.css(b.getMove())):0==b.curIndex&&(b.curIndex=b.size),b.curIndex--),b.options.isAuto&&b.autoPlay(),b.setTitle(),b.setPages(),b.options.onMoveBefore.call(b.$container,b.$item,b.curIndex),b.$item.fadeOut(b.options.affectTime).eq(b.curIndex).fadeIn(b.options.affectTime,function(){b.options.onMoveAfter.call(this,b.$item,b.curIndex)})},setPages:function(){if(this.options.isShowPage&&this.$pages){var b=this.curIndex;b==this.size-1&&"move"==this.options.mode&&(b=0),a("span",this.$pages).eq(b).addClass("active").siblings().removeClass("active")}},setTitle:function(){if(this.options.isShowTitle&&this.$title){var b=this.$item.eq(this.curIndex);this.$title.html(a.isFunction(this.options.titleAttr)?this.options.titleAttr.call(b,this.curIndex):b.attr(this.options.titleAttr))}},setLayout:function(){this.options;var c=this.getSetCss();this.$item.css(c.item),this.$container.css(c.container).wrap('<div class="ccSlider-wrap"/>'),this.$wrap=this.$container.parent(),this.$wrap.css(c.wrap),this.options.isShowTitle&&(this.$title=a('<div class="ccSlider-title"/>').insertAfter(this.$container),this.setTitle()),this.options.isShowPage&&(this.$pages=a('<div class="ccSlider-pages">'+this.getPages()+"</div>").insertAfter(this.$container),this.pagesSwitch()),this.options.isShowControls&&(this.$prev=a('<div class="ccSlider-btn ccSlider-btn-prev"></div>'),this.$next=a('<div class="ccSlider-btn ccSlider-btn-next"></div>'),this.$container.after(this.$prev.add(this.$next)),this.controlsSwitch()),"move"==this.options.mode?(this.$container.append(this.$item.eq(0).clone().addClass("item-clone")),this.$item=this.$container.find(this.options.item),this.size=this.$item.size()):this.setFade(),this.options.onInited.call(this.$container,this.$item,this.options.startSlide)},resize:function(){var a,b=this;clearTimeout(a),a=setTimeout(function(){b.$wrap.add(b.$item).css(b.getSize(b.options.direction)),b.$container.css(b.getMove(!0))},300)},setFade:function(){this.$item.hide().eq(this.curIndex).show()},getSetCss:function(){var a=this.getSize(),b={},c=Math.min(this.options.startSlide,this.size);return"fade"==this.options.mode?(a.position="absolute",b.height=a.height,b.width=a.width):("top"==this.options.direction?(b.height=100*(this.size+1)+"%",b.width=a.width,b.top=-(c*a.height)):(b.height=a.height,b.width=100*(this.size+1)+"%",b.left=-(c*a.width),a.float="left"),b.position="relative"),{item:a,container:b,wrap:{overflow:"hidden",position:"relative",width:a.width,height:a.height}}},autoPlay:function(){var b=this;clearTimeout(b.playTimer),b.playTimer=setTimeout(a.proxy(b,b.options.mode),b.options.intervalTime)},onHover:function(){var b=this;this.options.isHover&&a(this.$wrap).hover(function(){clearTimeout(b.playTimer)},function(){b.options.isAuto&&b.autoPlay()})},controlsSwitch:function(){var b=this;this.$next.on("click",a.proxy(b,b.options.mode)),this.$prev.on("click",a.proxy(b,b.options.mode+"Prev"))},pagesSwitch:function(){if(this.options.isShowPage&&this.$pages){var b=this;a("span",this.$pages).on("click",function(){b.curIndex=a(this).index(),b.options.onSelected.call(this,b.curIndex),b[b.options.mode+"Prev"](!0)})}},getPages:function(){var b=[],c=this.curIndex;return a(this.$item).each(function(a){var d=a==c?'class="active"':"";b.push("<span "+d+">"+(a+1)+"</span>")}),b.join("")},getSize:function(){var c,b=this.$item.eq(0);return this.options.isFullScreen?c={width:a(window).width(),height:a(window).height()}:this.options.isFlexible&&(b=this.$wrap?this.$wrap.parent():this.$container.parent(),c="top"==this.options.direction?{height:b.height()}:{width:b.width()}),c||{width:b.width(),height:b.height()}}},a.fn.ccSlider=function(c){return this.each(function(){a(this).data(".slider",new b(a(this),c))}),this}}(window.jQuery);